<!DOCTYPE html>
<html lang="it">
<head>
    <title>I Giocatori | Cripta di Sangue</title>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Crimson+Text:ital,wght@0,400;0,600;1,400&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

    <link rel="stylesheet" href="../assets/css/abyssal.css">

</head>
<body>

    <!-- NAVIGAZIONE LATERALE -->
    <nav class="sidebar" id="sidebar-container">
    </nav>

    <!-- CONTENUTO PRINCIPALE -->
    <main class="main-content">
        
        <header class="hero-mini">
            <div class="hero-title">
                <h1>I Protagonisti</h1>
                <div class="subtitle">Coloro che sfidano il Destino</div>
            </div>
        </header>

        <div class="container">

            <div class="npc-list" id="player-list-container">
                <!-- I giocatori verranno caricati qui dinamicamente -->
            </div>
            
            <div style="text-align: center; margin-top: 4rem; opacity: 0.4;">
                <i class="fas fa-users" style="font-size: 2rem; margin-bottom: 1rem; color: var(--gold);"></i>
                <p>Il gruppo avanza nell'oscurit√†...</p>
            </div>

        </div>
    </main>

    <script src="../assets/js/layout.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const container = document.getElementById('player-list-container');
            
            fetch('../assets/data/players.json')
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(players => {
                    if (players.length === 0) {
                        container.innerHTML = '<p>Nessun giocatore trovato.</p>';
                        return;
                    }

                    // Ordina i giocatori per nome
                    players.sort((a, b) => a.name.localeCompare(b.name));

                    players.forEach(player => {
                        // Adjust image paths for the current page (giocatori.html)
                        const avatarPath = player.images.avatar.replace('../../', '../');
                        const hoverPath = player.images.hover.replace('../../', '../');

                        const playerCard = `
                            <a href="../pages/characters/character.html?id=${player.id}&type=player" class="npc-card">
                                <div class="npc-avatar-container">
                                    <img src="${avatarPath}" alt="${player.name}" class="npc-img-pop img-main" onerror="this.src='httpshttps://placehold.co/200x200/1a1a1a/gold?text=${player.name.charAt(0)}'">
                                    <img src="${hoverPath}" alt="${player.name} Full" class="npc-img-pop img-hover" onerror="this.style.display='none'">
                                </div>
                                <div class="npc-info">
                                    <div class="npc-header">
                                        <h3 class="npc-name">${player.name}</h3>
                                        <span class="npc-role">${player.role}</span>
                                    </div>
                                    <p class="npc-desc">
                                        ${player.description}
                                    </p>
                                </div>
                                <i class="fas fa-chevron-right arrow-icon"></i>
                            </a>
                        `;
                        container.insertAdjacentHTML('beforeend', playerCard);
                    });
                })
                .catch(error => {
                    console.error('Errore nel caricamento dei dati dei giocatori:', error);
                    container.innerHTML = '<p style="color: var(--status-dead);">Impossibile caricare i dati dei giocatori. Controlla la console per maggiori dettagli.</p>';
                });
        });
    </script>

</body>
</html>